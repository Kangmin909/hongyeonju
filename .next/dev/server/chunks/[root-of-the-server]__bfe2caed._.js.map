{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/kangmin/Desktop/project/hongyeonju/src/pages/api/getCV1.js"],"sourcesContent":["import { Client } from \"@notionhq/client\";\n\nconst notion = new Client({ auth: process.env.NOTION_TOKEN });\n\nlet localCache = null;\nlet lastFetchTime = 0;\nconst CACHE_TTL = 1000 * 60 * 30;\n\nexport default async function handler(req, res) {\n  const { force } = req.query;\n\n  if (force !== \"true\" && localCache && (Date.now() - lastFetchTime < CACHE_TTL)) {\n    res.setHeader(\"Cache-Control\", \"s-maxage=1800, stale-while-revalidate=3600\");\n    return res.status(200).json(localCache);\n  }\n\n  try {\n    const databaseId = process.env.NOTION_CV1_DB_ID;\n\n    const response = await notion.databases.query({\n      database_id: databaseId,\n    });\n\n    const data = response.results.map((page) => {\n      const p = page.properties;\n      const getPlainText = (prop) => {\n        if (!prop) return \"\";\n        if (prop.title) return prop.title[0]?.plain_text || \"\";\n        if (prop.rich_text) return prop.rich_text[0]?.plain_text || \"\";\n        if (prop.select) return prop.select.name || \"\";\n        return \"\";\n      };\n\n      return {\n        id: getPlainText(p.id),\n        year: getPlainText(p.year),\n        content: getPlainText(p.content),\n      };\n    });\n\n    localCache = data;\n    lastFetchTime = Date.now();\n    res.setHeader(\"Cache-Control\", \"s-maxage=1800, stale-while-revalidate=3600\");\n    res.status(200).json(data);\n  } catch (err) {\n    console.error(\"CV1 API Error:\", err);\n    res.status(500).json({ error: \"Failed to load CV1\" });\n  }\n}"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,SAAS,IAAI,sMAAM,CAAC;IAAE,MAAM,QAAQ,GAAG,CAAC,YAAY;AAAC;AAE3D,IAAI,aAAa;AACjB,IAAI,gBAAgB;AACpB,MAAM,YAAY,OAAO,KAAK;AAEf,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,KAAK;IAE3B,IAAI,UAAU,UAAU,cAAe,KAAK,GAAG,KAAK,gBAAgB,WAAY;QAC9E,IAAI,SAAS,CAAC,iBAAiB;QAC/B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IAC9B;IAEA,IAAI;QACF,MAAM,aAAa,QAAQ,GAAG,CAAC,gBAAgB;QAE/C,MAAM,WAAW,MAAM,OAAO,SAAS,CAAC,KAAK,CAAC;YAC5C,aAAa;QACf;QAEA,MAAM,OAAO,SAAS,OAAO,CAAC,GAAG,CAAC,CAAC;YACjC,MAAM,IAAI,KAAK,UAAU;YACzB,MAAM,eAAe,CAAC;gBACpB,IAAI,CAAC,MAAM,OAAO;gBAClB,IAAI,KAAK,KAAK,EAAE,OAAO,KAAK,KAAK,CAAC,EAAE,EAAE,cAAc;gBACpD,IAAI,KAAK,SAAS,EAAE,OAAO,KAAK,SAAS,CAAC,EAAE,EAAE,cAAc;gBAC5D,IAAI,KAAK,MAAM,EAAE,OAAO,KAAK,MAAM,CAAC,IAAI,IAAI;gBAC5C,OAAO;YACT;YAEA,OAAO;gBACL,IAAI,aAAa,EAAE,EAAE;gBACrB,MAAM,aAAa,EAAE,IAAI;gBACzB,SAAS,aAAa,EAAE,OAAO;YACjC;QACF;QAEA,aAAa;QACb,gBAAgB,KAAK,GAAG;QACxB,IAAI,SAAS,CAAC,iBAAiB;QAC/B,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IACvB,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,kBAAkB;QAChC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IACrD;AACF"}}]
}